<!DOCTYPE html>
<!--[if IE 8]>
  <html class="no-js lt-ie9" lang="en">
  <![endif]-->
<!--[if gt IE 8]>
    <!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <meta name="author" content="JPush Offical"> 
    <title>JMessage WEB SDK 开发文档 - 极光文档</title> 
    <link rel="shortcut icon" href="../../favicon.ico">
    <script src="../../js/jquery-2.1.4.js"></script>

    <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
    <script src="../../js/bootstrap/js/bootstrap.js"></script>

    <link href="../../js/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
    
    <script>
    // Current page data
    var mkdocs_page_name = "JMessage WEB SDK 开发文档";
    var mkdocs_page_input_path = "client/im_sdk_js.md";
    var mkdocs_page_url = "/client/im_sdk_js/";
    </script>
    
    <script src="../../js/jpush.js"></script> 
</head>

<body data-spy="scroll" data-target="#navbar-right">
    <div class="container-fluid">
        <div class="container">
            <div class="row">
                <div class="col-lg-3  col-md-3  col-sm-3 ">
                    <div id="doc-icon">
                        <a href="/"><img src="/img/icon/logo.png"></a>
                    </div>
                </div>
                <div class="col-lg-7 col-md-8  col-sm-8">
                    <div class="header">
                        <ul class="nav nav-tabs">
                            <li role="presentation" >
                                <a href="/jpush/guideline/intro/" id="jpush-top">JPush</a></li>
                            <li role="presentation" >
                                <a href="/jmessage/guideline/jmessage_guide/" id="jmessage-top">JMessage</a></li>
                            <li role="presentation" >
                                <a href="/jsms/guideline/JSMS_guide/" id="jsms-top">短信验证码</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-2  col-md-1 col-sm-1">
                    <div>
                        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-lg-3  col-md-3 col-sm-4">
                <div id="navbar-left">
                    <ul class="wy-menu">
                        
                        <li class="subnav">
                            
                            <ul class="subnavul">
                                <li class="subnavli">
                                    <span>
                                <a href="#">
                                    入门指南 
                                <div class="nav-icon">
                                    <img src="/img/icon/right.png">
                                </div>                 
                                </a>
                                </span>
                                </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../../guideline/jmessage_guide/">JMessage 产品简介</a>
    </li>
                                
                                
                                </ul>
                                <li>
                        <li class="subnav">
                            
                            <ul class="subnavul">
                                <li class="subnavli">
                                    <span>
                                <a href="#">
                                    Android 
                                <div class="nav-icon">
                                    <img src="/img/icon/right.png">
                                </div>                 
                                </a>
                                </span>
                                </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../im_sdk_android/">Android SDK 概述</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../jmessage_android_guide/">JMessage Android SDK 集成指南</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../im_errorcode_android/">IM SDK ErrorCode 定义</a>
    </li>
                                
                                
                                </ul>
                                <li>
                        <li class="subnav">
                            
                            <ul class="subnavul">
                                <li class="subnavli">
                                    <span>
                                <a href="#">
                                    iOS 
                                <div class="nav-icon">
                                    <img src="/img/icon/right.png">
                                </div>                 
                                </a>
                                </span>
                                </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../im_sdk_ios/">iOS SDK 概述</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../jmessage_ios_guide/">JMessage iOS SDK 集成指南</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../im_errorcode_ios/">IM SDK ErrorCode 定义</a>
    </li>
                                
                                
                                </ul>
                                <li>
                        <li class="subnav">
                            
                            <ul class="subnavul">
                                <li class="subnavli">
                                    <span>
                                <a href="#">
                                    JS 
                                <div class="nav-icon">
                                    <img src="/img/icon/right.png">
                                </div>                 
                                </a>
                                </span>
                                </li>
                                
                                    <li class="toctree-l1 current">
        <a class="current" href="./">JMessage WEB SDK 开发文档</a>
    </li>
                                
                                
                                </ul>
                                <li>
                        <li class="subnav">
                            
                            <ul class="subnavul">
                                <li class="subnavli">
                                    <span>
                                <a href="#">
                                    REST API 
                                <div class="nav-icon">
                                    <img src="/img/icon/right.png">
                                </div>                 
                                </a>
                                </span>
                                </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../../server/rest_api_im/">IM REST API</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../../server/rest_api_im_report/">IM REST Report</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../im_errorcode_server/">Server ErrorCode 定义</a>
    </li>
                                
                                
                                </ul>
                                <li>
                        <li class="subnav">
                            
                            <ul class="subnavul">
                                <li class="subnavli">
                                    <span>
                                <a href="#">
                                    高级 
                                <div class="nav-icon">
                                    <img src="/img/icon/right.png">
                                </div>                 
                                </a>
                                </span>
                                </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../../advanced/im_message_protocol/">IM 消息协议</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../../advanced/im_objects/">IM 业务对象</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../../advanced/jmessage_callback/">实时消息回调</a>
    </li>
                                
                                    <li class="toctree-l1 ">
        <a class="" href="../../advanced/jmessage_topics/">极光IM高级话题</a>
    </li>
                                
                                
                                </ul>
                                <li>
                        <li class="subnav">
                            
                                <ul class="subnavul">
                                    <li class="subnavli_single " >
                                        <span>
                          <a href="../../updates/" class="">最近更新</a></span>
                                    </li>
                                </ul>
                                <li>
                        <li class="subnav">
                            
                                <ul class="subnavul">
                                    <li class="subnavli_single " >
                                        <span>
                          <a href="../../resources/" class="">资源下载</a></span>
                                    </li>
                                </ul>
                                <li></ul>
                    </ul>
                </div>
            </div>
            <div class="col-lg-8  col-md-9  col-sm-8">
                <div id="content-top"></div>
                <section >
                    <div class="rst-content"><div id="breadcrumbs" role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../guideline/jmessage_guide/">极光文档</a>></li>
    
      
        
          <li><a href="./">JS</a> ></li>
        
      
    
    <li>
    JMessage WEB SDK 开发文档
    <!--
    <a href="./">JMessage WEB SDK 开发文档</a>
    -->
    </li>
  </ul>
</div>
                        <div role="main">
                            <div class="section"> <h2 id="jmessage-web-sdk">JMessage WEB SDK 开发文档</h2>
<h3 id="sdk">SDK概述</h3>
<p>极光WebIM SDK 为 Web 应用提供一个 IM 系统开发框架, 屏蔽掉 IM 系统的复杂的细节, 对外提供较为简洁的 API 接口, 方便第三方应用快速集成 IM 功能。</p>
<h3 id="_1">签名算法</h3>
<p>开发者在执行登录的时候，需要传入auth_payload。 该数据结构由开发者服务端生成并传回浏览器，用于开发者授权此浏览器运行的JMessage登录。开发者需确保能调用获取到此数据的皆为合法用户。</p>
<p>auth_payload的数据结构如下:  </p>
<pre><code>{
    &quot;appkey&quot;: &quot;7e42e869baa2fbca8ccb823c&quot;,
    &quot;random_str&quot;: &quot;022cd9fd995849b58b3ef0e943421ed9&quot;,
    &quot;signature&quot;: &quot;E422A978DE37196588531CD0C42010B5&quot;,
    &quot;timestamp&quot;: &quot;1467967210887&quot;
}
</code></pre>

<p>参数说明:</p>
<ul>
<li>appkey : 开发者在极光平台注册的IM应用appkey</li>
<li>random_str : 20-36长度的随机字符串, 作为签名加salt使用</li>
<li>timestamp : 当初时间戳，用于防止重放攻击</li>
<li>signature : 签名</li>
</ul>
<p>签名生成算法如下:  </p>
<pre><code>signature = md5(appkey=appkey&amp;timestamp=timestamp&amp;random_str=random_str&amp;key=secret)
</code></pre>

<p>其中secret为开发者在极光平台注册的IM应用masterSecret。</p>
<h3 id="_2">开发准备</h3>
<h4 id="1-sockitiojs">1  引入sockit.io.js</h4>
<p>JiGuang WebIM是基于<a href="http://socket.io/">sockit.io</a>开发，开发者在使用之前需引入<code>sockit.io.js</code>。</p>
<p>CDN源:</p>
<pre><code>// 官网CDN源
&lt;script src=&quot;//cdn.socket.io/socket.io-1.4.5.js&quot;&gt;&lt;/script&gt;

// bootcdn源
&lt;script src=&quot;//cdn.bootcss.com/socket.io/1.4.5/socket.io.min.js&quot;&gt;&lt;/script&gt;
</code></pre>

<p>以上CDN源引入任一一个即可，开发者也可以将socket.io.js下载到自己的项目目录并手动引入，建议引入最新版本的socket.io。</p>
<h4 id="2-jmessage-web-sdkminjs">2  引入jmessage-web-sdk.min.js</h4>
<pre><code>&lt;script src='./jmessage-sdk-web-1.0.0.min.js'&gt;&lt;/script&gt;
</code></pre>

<p>引入该js后便可使用window上的全局变量<code>JIM</code>。</p>
<h4 id="3-jiminit">3  调用JIM.init()进行初始化。</h4>
<pre><code>JIM.init({debug:true});
</code></pre>

<h3 id="api">API</h3>
<h4 id="jiminit">初始化 JIM.init()</h4>
<p>PS: 此API是进行<code>JIM.login()</code>的前置动作，需要调用此接口才能进行登录操作。</p>
<p><strong>Params:</strong>  </p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>debug</td>
<td>boolean</td>
<td>FALSE</td>
<td>是否开启DEBUG模式，DEBUG模式会有更多日志打印，默认不开窍</td>
<td></td>
</tr>
<tr>
<td>address</td>
<td>string</td>
<td>FALSE</td>
<td>JMessage服务器地址，一般不需要指定，默认即可</td>
<td></td>
</tr>
<tr>
<td>timeout</td>
<td>string</td>
<td>FALSE</td>
<td>请求超时时间，默认为30秒</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong>  </p>
<pre><code class="javascript">JIM.init({
  debug: true //是否开启debug模式
})
</code></pre>

<h4 id="jimlogin">登陆 JIM.login()</h4>
<p>PS: 此API是IM业务方法的前置动作，需要登录后，才能进行后续的接口调用
PS: sdk中集成了MD5处理，用户可以自由选择传入的密码是否做过MD5处理。</p>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>username</td>
<td>string</td>
<td>TRUE</td>
<td>用户名</td>
</tr>
<tr>
<td>password</td>
<td>string</td>
<td>TRUE</td>
<td>明文密码或进行MD5处理后的用户密码</td>
</tr>
<tr>
<td>auth_payload</td>
<td>json</td>
<td>TRUE</td>
<td>签名，具体创建方法见签名算法</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>is_md5</td>
<td>boolean</td>
<td>FALSE</td>
<td>传入的密码是否已经做了MD5处理：不传或者值为false，则sdk会对传入的密码做md5处理；传入的值为true，则sdk不会对传入的密码做md5处理</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong>  </p>
<pre><code class="javascript">JIM.login(username, password, auth_payload, function(data) {
    // 登录结果返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
}, is_md5);
</code></pre>

<h4 id="jimgetuserinfo">获取用户信息 JIM.getUserInfo()</h4>
<p><strong>Params:</strong>
| KEY              | TYPE | REQUIRE | DESCIPTION                                   |
| ---------------- | ---- | ------- | ------------------------                     |
| username         | string | TRUE    | 用户名                                       |
| resp_callback    | function | FALSE   | 返回数据处理回调函数，不处理则忽略或传入null |
| ack_callback     | function | FALSE   | 请求送达回调函数，不处理则忽略或传入null     |
| timeout_callback | function | FALSE   | 请求超时回调函数，不处理则忽略或传入null     |</p>
<p><strong>Example:</strong></p>
<pre><code>JIM.getUserInfo('xiezefan', 'username', function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimsendsinglemsg">发送单聊消息 JIM.sendSingleMsg()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_username</td>
<td>string</td>
<td>TRUE</td>
<td>消息接受者username</td>
</tr>
<tr>
<td>target_nickname</td>
<td>string</td>
<td>TRUE</td>
<td>消息接受者nickname</td>
</tr>
<tr>
<td>content</td>
<td>json</td>
<td>TRUE</td>
<td>消息文本</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.sendSingleMsg(friend_id, 'Hi, JPush', function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimsendgroupmsg">发送群组消息 JIM.sendGroupMsg()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_gid</td>
<td>string</td>
<td>TRUE</td>
<td>消息接受群组gid</td>
</tr>
<tr>
<td>group_name</td>
<td>string</td>
<td>TRUE</td>
<td>群组消息name</td>
</tr>
<tr>
<td>content</td>
<td>json</td>
<td>TRUE</td>
<td>消息文本</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.sendGroupMsg(group_id, 'Hi, JPush', function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="msgbuilder-jimcreatemsgbuilder">获取消息构建器MsgBuilder JIM.createMsgBuilder()</h4>
<p><strong>MsgBuilder</strong></p>
<p>MsgBuilder提供链式调用风格的API帮助开发者构建符合<a href="http://docs.jiguang.cn/advanced/im_message_protocol/">JMessage消息协议</a>的聊天消息对象。</p>
<p>主要提供一下方法:  </p>
<ul>
<li>setType(type) 设置消息类型<ul>
<li>type : 消息类型，必填，取值single或group</li>
</ul>
</li>
<li>setTarget(target, target_name) 设置消息接受对象<ul>
<li>target : 消息接收对象，必填，单聊消息为username，群聊消息为group_id</li>
<li>target_name : 消息接受者名称，非必须，单聊消息为用户昵称，群聊消息为群组名称，如果不填，JMessage Server会自动填充</li>
</ul>
</li>
<li>setFromName(from_name) 设置发送者名称<ul>
<li>from_name : 发送者名称，非必填，如不填，JMessage Server会自动填充</li>
</ul>
</li>
<li>setText(content, extras) 设置文本消息<ul>
<li>content : 文本消息内容，必填</li>
<li>extras : 附加参数, 任意格式的JSON对象，非必填</li>
</ul>
</li>
<li>setCustom(custom) 设置自定义消息<ul>
<li>custom : 自定义消息对象，必填 </li>
</ul>
</li>
<li>send($resp, $ack, $timeout) 发送消息<ul>
<li>$resp : 返回数据处理回调函数，不处理则忽略或传入null</li>
<li>$ack : 请求送达回调函数，不处理则忽略或传入null</li>
<li>$timeout : 请求超时回调函数，不处理则忽略或传入null</li>
</ul>
</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="javascript">JIM.createMsgBuilder()
        .setType('single')
        .setTarget(friend_name, 'friend_nickname')
        .setFromName('from_name')
        .setImage('media_id', 'media_crc32', 600, 400, 'format', 'fsize', 'img_link', {'key1':'value1', 'key2':'value2'})
        .send(function(data) {
            // 返回处理
        }, function(ack) {
            // 请求送达JMessage服务器事件处理
        }, function(timeout) {
            // 请求发送超时事件处理
        });  

</code></pre>

<h4 id="jimcreategroup">创建群组 JIM.createGroup()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>group_name</td>
<td>string</td>
<td>TRUE</td>
<td>群组名称</td>
</tr>
<tr>
<td>group_description</td>
<td>string</td>
<td>TRUE</td>
<td>群组描述</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code class="javascript">JIM.createGroup('Group Name', 'Group Description', function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimgetgrouplist">获取群组列表 JIM.getGroupList()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.getGroupList(function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimgetgroupinfo">获取群组信息 JIM.getGroupInfo()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>gid</td>
<td>string</td>
<td>TRUE</td>
<td>群组gid</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code class="javascript">JIM.getGroupInfo(group_id, function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimaddgroupmember">增加群组成员 JIM.addGroupMember()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>gid</td>
<td>string</td>
<td>TRUE</td>
<td>群组gid</td>
</tr>
<tr>
<td>username_list</td>
<td>array</td>
<td>TRUE</td>
<td>增加进群组的用户名列表</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.addGroupMember(group_id, ['xiezefan01', 'xiezefan02', 'xiezefan03'], function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimdelgroupmember">删除群组成员 JIM.delGroupMember()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>gid</td>
<td>string</td>
<td>TRUE</td>
<td>群组gid</td>
</tr>
<tr>
<td>username_list</td>
<td>array</td>
<td>TRUE</td>
<td>增加进群组的用户名列表</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.delGroupMember(group_id, ['xiezefan01', 'xiezefan02', 'xiezefan03'], function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimgetgroupmembers">获取群组成员列表 JIM.getGroupMembers()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>gid</td>
<td>string</td>
<td>TRUE</td>
<td>群组gid</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.getGroupMembers(group_id, function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimupdategroupinfo">更新群组信息 JIM.updateGroupInfo()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>gid</td>
<td>string</td>
<td>TRUE</td>
<td>群组gid</td>
</tr>
<tr>
<td>group_name</td>
<td>string</td>
<td>TRUE</td>
<td>群组名称</td>
</tr>
<tr>
<td>group_description</td>
<td>string</td>
<td>TRUE</td>
<td>群组描述</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.updateGroupInfo(group_id, 'New Group Name', 'New Group Description', function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimexitgroup">退出群组 JIM.exitGroup()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>gid</td>
<td>string</td>
<td>TRUE</td>
<td>群组gid</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.exitGroup(group_id, function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimgetconversations">获取会话列表 JIM.getConversations()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.getConversations(function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimgetnodisturb">获取免打扰 JIM.getNoDisturb()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.getNoDisturb(function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimaddsinglenodisturb">添加单聊免打扰 JIM.addSingleNoDisturb()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_name</td>
<td>string</td>
<td>true</td>
<td>需要设置为免打扰的单聊用户target_name</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.addSingleNoDisturb(target_name, function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimdeletesinglenodisturb">删除单聊免打扰 JIM.deleteSingleNoDisturb()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>target_name</td>
<td>string</td>
<td>true</td>
<td>需要取消为免打扰的单聊用户target_name</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.deleteSingleNoDisturb(target_name, function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimaddgroupnodisturb">添加群聊免打扰 JIM.addGroupNoDisturb()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>gid</td>
<td>string</td>
<td>true</td>
<td>需要设置为免打扰的群组gid</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.addGroupNoDisturb(gid, function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimdeletegroupnodisturb">删除群聊免打扰 JIM.deleteGroupNoDisturb()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>gid</td>
<td>string</td>
<td>true</td>
<td>需要删除为免打扰的群组gid</td>
</tr>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.deleteGroupNoDisturb(gid, function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimaddglobalnodisturb">添加全局免打扰 JIM.addGlobalNoDisturb()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.addGlobalNoDisturb(function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimdeleteglobalnodisturb">删除全局免打扰 JIM.deleteGlobalNoDisturb()</h4>
<p><strong>Params:</strong></p>
<table>
<thead>
<tr>
<th>KEY</th>
<th>TYPE</th>
<th>REQUIRE</th>
<th>DESCIPTION</th>
</tr>
</thead>
<tbody>
<tr>
<td>resp_callback</td>
<td>function</td>
<td>FALSE</td>
<td>返回数据处理回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>ack_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求送达回调函数，不处理则忽略或传入null</td>
</tr>
<tr>
<td>timeout_callback</td>
<td>function</td>
<td>FALSE</td>
<td>请求超时回调函数，不处理则忽略或传入null</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<pre><code>JIM.deleteGlobalNoDisturb(function(data) {
    // 返回处理
}, function(ack) {
    // 请求送达JMessage服务器事件处理
}, function(timeout) {
    // 请求发送超时事件处理
});
</code></pre>

<h4 id="jimloginout">登出 JIM.loginOut()</h4>
<h4 id="_3">聊天消息监听</h4>
<p><strong>Example:</strong></p>
<pre><code>JIM.onMsgReceive(function(data) {
    // 聊天消息处理
});
</code></pre>

<p><strong>Msg Payload Example</strong></p>
<pre><code>{
  &quot;target_type&quot;: &quot;single&quot;, //&quot;single&quot;为单聊，&quot;group&quot;为群聊
  &quot;target_name&quot;: &quot;user1&quot;, //接收用户的昵称，当target_type为single时，target_name对应的是单聊用户的昵称，当target_type为group时，target_name对应的是群组的名称
  &quot;target_id&quot;: &quot;userid1&quot;, //接收用户的id，当target_type为single时，target_name对应的是单聊用户的id，当target_type为group时，target_name对应的是群组的gid
  &quot;from_name&quot;: &quot;user2&quot;, //发送用户的昵称，当target_type为single时，from_name对应的是单聊用户的昵称，当target_type为group时，from_name对应的是群组的名称
  &quot;from_id&quot;: &quot;userid2&quot;, //发送用户的id，当target_type为single时，from_id对应的是单聊用户的id，当target_type为group时，from_id对应的是群组的gid
  &quot;from_platform&quot;: &quot;web&quot;, //发送消息的平台
  &quot;create_time&quot;: 1472128104291, //消息创建时间戳
  &quot;msg_type&quot;: &quot;text&quot;, //消息类型，有文本-&quot;text&quot;, 图片-&quot;image&quot;, 语音-&quot;voice&quot;, 文件-&quot;file&quot;
  &quot;msg_body&quot;: {
    &quot;text&quot;: &quot;HI, Jpush&quot;, //文本信息
    &quot;media_id&quot;: &quot;id&quot;, //MEDIA 文件上传之后服务器端所返回的key，用于之后生成下载的url
    &quot;media_crc32&quot;: &quot;stirng&quot;, // 文件的crc32校验码
    &quot;format&quot;: &quot;type&quot;, //文件格式
    &quot;duration&quot;: 200, //语音消息的时长，单位秒
    &quot;fsize&quot;: 300, //文件大小（字节数）
    &quot;media_url&quot;: &quot;url&quot; //文件，图片，语音类消息的资源下载地址
  }, //消息体, 消息的内容都在消息体中,ps:不同的消息类型，返回值有所区别，这里只是字段示例
  &quot;msg_level&quot;: &quot;normal&quot; //&quot;normal&quot;-普通，&quot;across&quot;-跨应用
}
</code></pre>

<h4 id="_4">业务事件监听</h4>
<p><strong>Example:</strong>  </p>
<pre><code>JIM.onEvent(function(data) {
    // 业务事件处理
});
</code></pre>

<p><strong>Event Payload Example</strong></p>
<pre><code>{
  &quot;uid&quot;: 16836751, 
  &quot;event_id&quot;: 59826578, // 事件ID
  &quot;event_type&quot;: 12, // 事件类型
  &quot;gid&quot;: 10210335,
  &quot;to_uidlist&quot;: [], // 事件当事人
  &quot;extra&quot;: 0, // 用于好友邀请事件：1-来自邀请方的事件，2－来自被邀请方，即好友邀请的应答事件
  &quot;description&quot;: {
    &quot;validUtf8&quot;: true,
    &quot;empty&quot;: true
  },
  &quot;ctime&quot;: 1468152292, // event_id 生成时间，单位秒
  &quot;rid&quot;: 59826578, // 流水ID
  &quot;event&quot;: &quot;event_notification&quot;,
  &quot;return_code&quot;: 0, // 用于好友邀请应答事件：0－添加好友成功，其他为添加好友被拒绝的返回码
  &quot;from_uid&quot;: 16836751 // 事件发起者
}
</code></pre> </div>
                        </div> <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../server/rest_api_im/" class="btn btn-neutral float-right" title="IM REST API">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../im_errorcode_ios/" class="btn btn-neutral float-left" title="IM SDK ErrorCode 定义"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright 2011-2016, jiguang.cn, All Rights Reserved. <br />粤ICP备12056275号-13 深圳市和讯华谷信息技术有限公司</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer> </div>
                </section>
            </div>
            <div class="col-lg-1">
                <div class="visible-lg">
                    <div id="tocright">
                        <div id="navbar-right">
                            <div>
                            <p>目录</p>
                            </div>
                            <ul class="nav" >
    
        
            <li><a href="#sdk">SDK概述</a></li>
        
            <li><a href="#_1">签名算法</a></li>
        
            <li><a href="#_2">开发准备</a></li>
        
            <li><a href="#api">API</a></li>
        
    
    </ul>
    


                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
</body>

</html>